<html>
    <head>
        <title>Generating a planet</title>

        <style> 
            body {margin: 0;}
            canvas {width: 100%; height: 100%;}
        </style>

    </head>

    <body>

        <script src="./js/three.js"></script>
        <script src="./js/simplex-noise.js"></script>
        <script src="./js/OrbitControls.js"></script>

        <style>
            body {
                font-family: Monospace;
                background-color: #666;
                color: #fff;
                margin: 0px;
                overflow: hidden;
            }
            #info {
                position: absolute;
                top: 10px;
                width: 100%;
                text-align: center;
            }
        </style>

        <script>
var scene = new THREE.Scene();
var ratio = window.innerWidth/window.innerHeight;

var camera = new THREE.PerspectiveCamera(70, ratio, 0.1, 1000);
var control = new THREE.OrbitControls(camera);

camera.position.set(0,0,15);
camera.lookAt(0,0,0);
control.update();

var renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);

document.body.appendChild(renderer.domElement);

var ambientlight = new THREE.AmbientLight(new THREE.Color(1,1,1),.5);
scene.add(ambientlight);

var cameralight = new THREE.PointLight( new THREE.Color(1,1,1), .8 );
cameralight.castShadow=true;
camera.add(cameralight);
scene.add(camera);

//create the material of the cube (basic material)
var material_cube = new THREE.MeshStandardMaterial();
//set the color of the cube
material_cube.color=  new THREE.Color(0,1,0);
material_cube.roughness=.8;

//then set the renderer to wireframe
material_cube.wireframe=false;

//Create the base terrain
var sphere_geometry = new THREE.SphereGeometry(5, 40, 20);

//Create the noise, then loop through all the vertices
var simplex = new SimplexNoise();
for (var i = 0; i < sphere_geometry.vertices.length; i++)
{
    var vert_pos_x = sphere_geometry.vertices[i].x;
    var vert_pos_y = sphere_geometry.vertices[i].y;
    var vert_pos_z = sphere_geometry.vertices[i].z;
    var dir = new THREE.Vector3(0,0,0);

    //Get the direction of the vertex
    dir.sub(new THREE.Vector3(vert_pos_x, vert_pos_y, vert_pos_z));
    
    var vert_noise = simplex.noise2D(vert_pos_x, vert_pos_y, vert_pos_z);
    sphere_geometry.vertices[i].addScaledVector(dir, vert_noise * 0.1);
}

var sphere = new THREE.Mesh(sphere_geometry, material_cube);
scene.add(sphere);

function animate(){
    requestAnimationFrame(animate);
    
    control.update();
    renderer.render(scene, camera);
}

requestAnimationFrame(animate);

        </script>
    </body>
</html>